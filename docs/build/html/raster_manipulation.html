<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Raster Manipulation &mdash; pyeo 1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="canonical" href="https://clcr.github.io/pyeo/raster_manipulation.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Validation" href="validation.html" />
    <link rel="prev" title="Queries and Downloads" href="queries_and_downloads.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pyeo
              <img src="_static/pyeo_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="acd_national.html">ACD National</a></li>
<li class="toctree-l1"><a class="reference internal" href="classification.html">Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="coordinate_manipulation.html">Coordinate Manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="filesystem_utilities.html">Filesystem Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="queries_and_downloads.html">Queries and Downloads</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Raster Manipulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#key-functions">Key functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rasters">Rasters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#timestamps">Timestamps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#supported-datatypes">Supported datatypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#geotransforms">Geotransforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#projections">Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#masks">Masks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#function-reference">Function reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.add_masks"><code class="docutils literal notranslate"><span class="pre">add_masks()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.align_image_in_place"><code class="docutils literal notranslate"><span class="pre">align_image_in_place()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.apply_array_image_mask"><code class="docutils literal notranslate"><span class="pre">apply_array_image_mask()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.apply_band_function"><code class="docutils literal notranslate"><span class="pre">apply_band_function()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.apply_image_function"><code class="docutils literal notranslate"><span class="pre">apply_image_function()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.apply_mask_to_dir"><code class="docutils literal notranslate"><span class="pre">apply_mask_to_dir()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.apply_mask_to_image"><code class="docutils literal notranslate"><span class="pre">apply_mask_to_image()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.apply_processing_baseline_0400_offset_correction_to_tiff_file_directory"><code class="docutils literal notranslate"><span class="pre">apply_processing_baseline_0400_offset_correction_to_tiff_file_directory()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.apply_processing_baseline_offset_correction_to_tiff_file_directory"><code class="docutils literal notranslate"><span class="pre">apply_processing_baseline_offset_correction_to_tiff_file_directory()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.apply_scl_cloud_mask"><code class="docutils literal notranslate"><span class="pre">apply_scl_cloud_mask()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.apply_sen2cor"><code class="docutils literal notranslate"><span class="pre">apply_sen2cor()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.array2raster"><code class="docutils literal notranslate"><span class="pre">array2raster()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.atmospheric_correction"><code class="docutils literal notranslate"><span class="pre">atmospheric_correction()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.average_images"><code class="docutils literal notranslate"><span class="pre">average_images()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.buffer_mask_in_place"><code class="docutils literal notranslate"><span class="pre">buffer_mask_in_place()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.build_sen2cor_output_path"><code class="docutils literal notranslate"><span class="pre">build_sen2cor_output_path()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.calc_ndvi"><code class="docutils literal notranslate"><span class="pre">calc_ndvi()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.change_from_class_maps"><code class="docutils literal notranslate"><span class="pre">change_from_class_maps()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.clever_composite_directory"><code class="docutils literal notranslate"><span class="pre">clever_composite_directory()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.clever_composite_directory_with_masks"><code class="docutils literal notranslate"><span class="pre">clever_composite_directory_with_masks()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.clever_composite_images"><code class="docutils literal notranslate"><span class="pre">clever_composite_images()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.clever_composite_images_with_mask"><code class="docutils literal notranslate"><span class="pre">clever_composite_images_with_mask()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.clip_raster"><code class="docutils literal notranslate"><span class="pre">clip_raster()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.clip_raster_to_intersection"><code class="docutils literal notranslate"><span class="pre">clip_raster_to_intersection()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.combine_date_maps"><code class="docutils literal notranslate"><span class="pre">combine_date_maps()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.combine_masks"><code class="docutils literal notranslate"><span class="pre">combine_masks()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.composite_directory"><code class="docutils literal notranslate"><span class="pre">composite_directory()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.composite_images_with_mask"><code class="docutils literal notranslate"><span class="pre">composite_images_with_mask()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.compress_tiff"><code class="docutils literal notranslate"><span class="pre">compress_tiff()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.create_mask_from_band"><code class="docutils literal notranslate"><span class="pre">create_mask_from_band()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.create_mask_from_class_map"><code class="docutils literal notranslate"><span class="pre">create_mask_from_class_map()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.create_mask_from_confidence_layer"><code class="docutils literal notranslate"><span class="pre">create_mask_from_confidence_layer()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.create_mask_from_fmask"><code class="docutils literal notranslate"><span class="pre">create_mask_from_fmask()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.create_mask_from_model"><code class="docutils literal notranslate"><span class="pre">create_mask_from_model()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.create_mask_from_scl_layer"><code class="docutils literal notranslate"><span class="pre">create_mask_from_scl_layer()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.create_mask_from_sen2cor_and_fmask"><code class="docutils literal notranslate"><span class="pre">create_mask_from_sen2cor_and_fmask()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.create_matching_dataset"><code class="docutils literal notranslate"><span class="pre">create_matching_dataset()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.create_new_image_from_polygon"><code class="docutils literal notranslate"><span class="pre">create_new_image_from_polygon()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.create_new_stacks"><code class="docutils literal notranslate"><span class="pre">create_new_stacks()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.create_quicklook"><code class="docutils literal notranslate"><span class="pre">create_quicklook()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.filter_by_class_map"><code class="docutils literal notranslate"><span class="pre">filter_by_class_map()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.find_small_safe_dirs"><code class="docutils literal notranslate"><span class="pre">find_small_safe_dirs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.flatten_probability_image"><code class="docutils literal notranslate"><span class="pre">flatten_probability_image()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.get_array"><code class="docutils literal notranslate"><span class="pre">get_array()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.get_dir_size"><code class="docutils literal notranslate"><span class="pre">get_dir_size()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.get_extent_as_shp"><code class="docutils literal notranslate"><span class="pre">get_extent_as_shp()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.get_file_sizes"><code class="docutils literal notranslate"><span class="pre">get_file_sizes()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.get_image_resolution"><code class="docutils literal notranslate"><span class="pre">get_image_resolution()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.get_masked_array"><code class="docutils literal notranslate"><span class="pre">get_masked_array()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.get_sen2cor_version"><code class="docutils literal notranslate"><span class="pre">get_sen2cor_version()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.get_sen_2_band_path"><code class="docutils literal notranslate"><span class="pre">get_sen_2_band_path()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.get_stats_from_raster_file"><code class="docutils literal notranslate"><span class="pre">get_stats_from_raster_file()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.mosaic_images"><code class="docutils literal notranslate"><span class="pre">mosaic_images()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.open_dataset_from_safe"><code class="docutils literal notranslate"><span class="pre">open_dataset_from_safe()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.preprocess_landsat_images"><code class="docutils literal notranslate"><span class="pre">preprocess_landsat_images()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.preprocess_sen2_images"><code class="docutils literal notranslate"><span class="pre">preprocess_sen2_images()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.raster2array"><code class="docutils literal notranslate"><span class="pre">raster2array()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.raster_sum"><code class="docutils literal notranslate"><span class="pre">raster_sum()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.raster_to_array"><code class="docutils literal notranslate"><span class="pre">raster_to_array()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.reproject_directory"><code class="docutils literal notranslate"><span class="pre">reproject_directory()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.reproject_image"><code class="docutils literal notranslate"><span class="pre">reproject_image()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.resample_image_in_place"><code class="docutils literal notranslate"><span class="pre">resample_image_in_place()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.save_array_as_image"><code class="docutils literal notranslate"><span class="pre">save_array_as_image()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.scale_to_uint8"><code class="docutils literal notranslate"><span class="pre">scale_to_uint8()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.sieve_directory"><code class="docutils literal notranslate"><span class="pre">sieve_directory()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.sieve_image"><code class="docutils literal notranslate"><span class="pre">sieve_image()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.stack_and_trim_images"><code class="docutils literal notranslate"><span class="pre">stack_and_trim_images()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.stack_image_with_composite"><code class="docutils literal notranslate"><span class="pre">stack_image_with_composite()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.stack_images"><code class="docutils literal notranslate"><span class="pre">stack_images()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.stack_old_and_new_images"><code class="docutils literal notranslate"><span class="pre">stack_old_and_new_images()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.stack_sentinel_2_bands"><code class="docutils literal notranslate"><span class="pre">stack_sentinel_2_bands()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.strip_bands"><code class="docutils literal notranslate"><span class="pre">strip_bands()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.trim_image"><code class="docutils literal notranslate"><span class="pre">trim_image()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.update_composite_with_images"><code class="docutils literal notranslate"><span class="pre">update_composite_with_images()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.verify_change_detections"><code class="docutils literal notranslate"><span class="pre">verify_change_detections()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyeo.raster_manipulation.write_n_band_tiff"><code class="docutils literal notranslate"><span class="pre">write_n_band_tiff()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectorisation.html">Vectorisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Applications</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyeo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Raster Manipulation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/raster_manipulation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pyeo.raster_manipulation">
<span id="raster-manipulation"></span><h1>Raster Manipulation<a class="headerlink" href="#module-pyeo.raster_manipulation" title="Permalink to this heading"></a></h1>
<p>Functions for working with raster data, including masks and platform-specific processing functions.</p>
<section id="key-functions">
<h2>Key functions<a class="headerlink" href="#key-functions" title="Permalink to this heading"></a></h2>
<p><a class="reference internal" href="#pyeo.raster_manipulation.create_matching_dataset" title="pyeo.raster_manipulation.create_matching_dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_matching_dataset()</span></code></a>  : Creates an empty raster of the same shape as a source, ready for writing.</p>
<p><a class="reference internal" href="#pyeo.raster_manipulation.stack_images" title="pyeo.raster_manipulation.stack_images"><code class="xref py py-func docutils literal notranslate"><span class="pre">stack_images()</span></code></a>  : Stacks a list of rasters into a single raster.</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">n2_images()</span></code>  : Preprocesses a set of of Sentinel-2 images into single raster files.</p>
<p><a class="reference internal" href="#pyeo.raster_manipulation.clip_raster" title="pyeo.raster_manipulation.clip_raster"><code class="xref py py-func docutils literal notranslate"><span class="pre">clip_raster()</span></code></a>  : Clips a raster to a shapefile</p>
</section>
<section id="rasters">
<h2>Rasters<a class="headerlink" href="#rasters" title="Permalink to this heading"></a></h2>
<p>When working with raster data (geotiff, .jp2, ect) using this module, the following assumptions have been made:</p>
<ul class="simple">
<li><p>Any function that reads a raster can read from any gdal-readable format</p></li>
<li><p>All interim rasters are stored internally as a geotiff</p></li>
<li><p>All internal rasters have a .tif extension in the filename</p></li>
<li><p>Unless otherwise stated, <strong>all rasters are assumed to be in a projected coordinate system</strong> - i.e. in meters.
Functions may fail if passed a raster in lat-long projection</p></li>
</ul>
</section>
<section id="timestamps">
<h2>Timestamps<a class="headerlink" href="#timestamps" title="Permalink to this heading"></a></h2>
<p>pyeo uses the same timestamp convention as ESA: <cite>yyyymmddThhmmss</cite>; for example, 1PM on 27th December 2020 would be
<cite>20201227T130000</cite>. All timestamps are in UTC</p>
</section>
<section id="supported-datatypes">
<h2>Supported datatypes<a class="headerlink" href="#supported-datatypes" title="Permalink to this heading"></a></h2>
<p>When a function in this library asks for a datatype, it can take one of the following</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Unknown</span>
<span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Byte</span>
<span class="n">gdal</span><span class="o">.</span><span class="n">GDT_UInt16</span>
<span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Int16</span>
<span class="n">gdal</span><span class="o">.</span><span class="n">GDT_UInt32</span>
<span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Int32</span>
<span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Float32</span>
<span class="n">gdal</span><span class="o">.</span><span class="n">GDT_Float64</span>
<span class="n">gdal</span><span class="o">.</span><span class="n">GDT_CInt16</span>
<span class="n">gdal</span><span class="o">.</span><span class="n">GDT_CInt32</span>
<span class="n">gdal</span><span class="o">.</span><span class="n">GDT_CFloat32</span>
<span class="n">gdal</span><span class="o">.</span><span class="n">GDT_CFloat64</span>
</pre></div>
</div>
</section>
<section id="geotransforms">
<h2>Geotransforms<a class="headerlink" href="#geotransforms" title="Permalink to this heading"></a></h2>
<p>Every gdal raster has a geotransform associated with it; this defines it’s top-left hand corner in the projection
and pixel size.
In pyeo, it takes the form of a 6-element tuple; for north-up images, these are the following.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">geotransform</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_left_x</span>
<span class="n">geotransfrom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pixel_width</span>
<span class="n">geotransform</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">geotransform</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_left_y</span>
<span class="n">geotransform</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">geotransform</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">pixel_height</span>
</pre></div>
</div>
<p>A geotransform can be obtained from a raster with the following snippet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s2">&quot;my_raster.tif&quot;</span><span class="p">)</span>
<span class="n">gt</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">GetGeoTransform</span><span class="p">()</span>
</pre></div>
</div>
<p>For more information, see the following: See the following: <a class="reference external" href="https://gdal.org/user/raster_data_model.html#affine-geotransform">https://gdal.org/user/raster_data_model.html#affine-geotransform</a></p>
</section>
<section id="projections">
<h2>Projections<a class="headerlink" href="#projections" title="Permalink to this heading"></a></h2>
<p>Each Gdal raster also has a projection, defining (among other things) the unit of the geotransform.
Projections in pyeo are referred to either by EPSG number or passed around as a wkt( well-known text) string.
You can look up EPSG values at <a class="reference external" href="https://epsg.io">https://epsg.io</a>
You can use the following snippet to extract the well-known text of a raster</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">projection</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">GetProjection</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="masks">
<h2>Masks<a class="headerlink" href="#masks" title="Permalink to this heading"></a></h2>
<p>Some functions in this module include options for creating and applying masks.</p>
<ul>
<li><p>A raster may have an associated mask</p></li>
<li><p>A mask is a geotif with an identical name as the raster it’s masking with a .msk extension</p>
<blockquote>
<div><ul class="simple">
<li><p>For example, the mask for my_sat_image.tif is my_sat_image.msk</p></li>
</ul>
</div></blockquote>
</li>
<li><p>A mask is</p>
<blockquote>
<div><ul class="simple">
<li><p>a single band raster</p></li>
<li><p>of identical height, width and resolution of the related image</p></li>
<li><p>contains values 0 or 1</p></li>
</ul>
</div></blockquote>
</li>
<li><p>A mask is applied by multiplying it with each band of its raster</p>
<blockquote>
<div><ul class="simple">
<li><p>So any pixel with a 0 in its mask will be removed, and a 1 will be kept</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="function-reference">
<h2>Function reference<a class="headerlink" href="#function-reference" title="Permalink to this heading"></a></h2>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.add_masks">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">add_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'union'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.add_masks" title="Permalink to this definition"></a></dt>
<dd><p>Creates a raster file by adding a list of mask files containing 0 and 1 values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_paths</strong> (<em>list</em><em> of </em><em>str</em>) – List of strings containing the full directory paths and file names of all masks to be added</p></li>
<li><p><strong>geometry_func</strong> (<em>{'intersect'</em><em> or </em><em>'union'}</em>) – How to handle non-overlapping masks. Defaults to ‘union’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_path</strong> – The path to the new raster file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.align_image_in_place">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">align_image_in_place</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.align_image_in_place" title="Permalink to this definition"></a></dt>
<dd><p>Adjusts the geotransform of the image at image_path with that of the one at target_path, so they align neatly with
the smallest magnitude of movement</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_path</strong> (<em>str</em>) – The path to the image to be adjusted.</p></li>
<li><p><strong>target_path</strong> (<em>str</em>) – The image to align the image at image_path to.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NonSquarePixelException</strong> – Raised if either image does not have square pixels</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.apply_array_image_mask">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">apply_array_image_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.apply_array_image_mask" title="Permalink to this definition"></a></dt>
<dd><p>Applies a mask of (y,x) to an image array of (bands, y, x). Replaces any masked pixels with fill_value
Mask is an a 2 dimensional array of 1 (unmasked) and 0 (masked)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>array_like</em>) – The array containing the raster data</p></li>
<li><p><strong>mask</strong> (<em>array_like</em>) – The array containing the mask</p></li>
<li><p><strong>fill_value</strong> (<em>number</em><em>, </em><em>optional</em>) – The value to replace any masked pixels with. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>masked_array</strong> – The array with masked pixels replaced with fill_value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.apply_band_function">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">apply_band_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_datatype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.apply_band_function" title="Permalink to this definition"></a></dt>
<dd><p>Applys an arbitrary band mathematics function to an image at in_path and saves the result at out_map.
Function should be a function object of the form f(band_input_A, band_input_B, …)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_path</strong> (<em>str</em>) – The image to process</p></li>
<li><p><strong>function</strong> (<em>Func</em>) – </p></li>
<li><p><strong>bands</strong> – </p></li>
<li><p><strong>out_path</strong> – </p></li>
<li><p><strong>out_datatype</strong> – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Calculating the NDVI of an image with red band at band 0 and IR band at 4
First, define the function to be run across each pixel:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">ndvi_function</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">apply_band_function</span><span class="p">(</span><span class="s2">&quot;my_raster.tif&quot;</span><span class="p">,</span> <span class="n">ndvi_function</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;my_ndvi.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.apply_image_function">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">apply_image_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_datatype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.apply_image_function" title="Permalink to this definition"></a></dt>
<dd><p>Applies a pixel-wise function across every image. Assumes each image is exactly contiguous and, for now,
single-banded. function() should take a list of values and return a single value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_paths</strong> (<em>list</em><em> of </em><em>str</em>) – list of raster paths to process</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – The path to the</p></li>
<li><p><strong>function</strong> (<em>function</em>) – The function to apply to the list of images. Must take a list of numbers as an input and return a value.</p></li>
<li><p><strong>out_datatype</strong> (<em>gdal datatype</em><em>, </em><em>optional</em>) – The datatype of the final raster. Defaults to gdal.gdt_Int32</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Producing a raster where each pixel contains the sum of the corresponding pixels in a list of other rasters</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sum_function</span><span class="p">(</span><span class="n">pixels_in</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pixels_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">in_paths</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;my_raster_dir&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apply_image_function</span><span class="p">(</span><span class="n">in_paths</span><span class="p">,</span> <span class="s2">&quot;sum_raster.tif&quot;</span><span class="p">,</span> <span class="n">sum_function</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.apply_mask_to_dir">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">apply_mask_to_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masked_image_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.apply_mask_to_dir" title="Permalink to this definition"></a></dt>
<dd><p>Iterates over all raster images in image_dir and applies the mask to each image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_path</strong> (<em>str</em>) – Paths and file name of the mask file</p></li>
<li><p><strong>image_dir</strong> (<em>str</em>) – Path and directory name which contains the raster image files in Geotiff format</p></li>
<li><p><strong>masked_image_dir</strong> (<em>str</em>) – Path and directory name in which the masked raster image files will be created</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.apply_mask_to_image">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">apply_mask_to_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masked_image_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.apply_mask_to_image" title="Permalink to this definition"></a></dt>
<dd><p>Applies a mask of 0 and 1 values to a raster image with one or more bands in Geotiff format
by multiplying each pixel value with the mask value.</p>
<dl class="simple">
<dt>After:</dt><dd><p><a class="reference external" href="https://pcjericks.github.io/py-gdalogr-cookbook/raster_layers.html">https://pcjericks.github.io/py-gdalogr-cookbook/raster_layers.html</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_path</strong> (<em>str</em>) – Paths and file name of the mask file</p></li>
<li><p><strong>image_path</strong> (<em>str</em>) – Path and file name of the raster image file</p></li>
<li><p><strong>masked_image_path</strong> (<em>str</em>) – Path and file name of the masked raster image file that will be created</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.apply_processing_baseline_0400_offset_correction_to_tiff_file_directory">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">apply_processing_baseline_0400_offset_correction_to_tiff_file_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_tif_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_tif_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands_to_offset_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('B02',</span> <span class="pre">'B03',</span> <span class="pre">'B04',</span> <span class="pre">'B08')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands_to_offset_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BOA_ADD_OFFSET</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.apply_processing_baseline_0400_offset_correction_to_tiff_file_directory" title="Permalink to this definition"></a></dt>
<dd><p>Offsets data within selected bands from a directory of stacked raster files
Overwrites original file - option to save a backup copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_tif_directory</strong> (<em>str</em>) – Path to the input (and output) directory of tif raster files</p></li>
<li><p><strong>out_tif_directory</strong> (<em>str</em>) – Path to the output directory of tif raster files</p></li>
<li><p><strong>bands_to_offset_labels</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of bands to offset</p></li>
<li><p><strong>bands_to_offset_index</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – List of indices of bands to offset within the tif image</p></li>
<li><p><strong>BOA_ADD_OFFSET</strong> (<em>int</em>) – Required offset per band (from xml information within L2A SAFE file directory)</p></li>
<li><p><strong>backup_flag</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True leaves unoffset images with .backup extension in tif_directory</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_tif_directory</strong> – The path to the output directory</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.apply_processing_baseline_offset_correction_to_tiff_file_directory">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">apply_processing_baseline_offset_correction_to_tiff_file_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_tif_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_tif_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands_to_offset_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('B02',</span> <span class="pre">'B03',</span> <span class="pre">'B04',</span> <span class="pre">'B08')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands_to_offset_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BOA_ADD_OFFSET</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.apply_processing_baseline_offset_correction_to_tiff_file_directory" title="Permalink to this definition"></a></dt>
<dd><p>Offsets data within selected bands from a directory of stacked raster files
Overwrites original file - option to save a backup copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_tif_directory</strong> (<em>str</em>) – Path to the input (and output) directory of tif raster files</p></li>
<li><p><strong>out_tif_directory</strong> (<em>str</em>) – Path to the output directory of tif raster files</p></li>
<li><p><strong>bands_to_offset_labels</strong> (<em>list</em><em> of </em><em>string</em>) – List of bands to offset</p></li>
<li><p><strong>bands_to_offset_index</strong> (<em>list</em><em> of </em><em>int</em>) – List of indices of bands to offset within the tif image</p></li>
<li><p><strong>BOA_ADD_OFFSET</strong> (<em>int</em>) – Required offset per band (from xml information within L2A SAFE file directory)</p></li>
<li><p><strong>backup_flag</strong> (<em>True/False</em>) – If True leaves unoffset images with .backup extension in tif_directory</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_tif_directory</strong> – The path to the output directory</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.apply_scl_cloud_mask">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">apply_scl_cloud_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l2_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scl_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['B02',</span> <span class="pre">'B03',</span> <span class="pre">'B04',</span> <span class="pre">'B08']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">haze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.apply_scl_cloud_mask" title="Permalink to this definition"></a></dt>
<dd><p>For every .SAFE folder in l2_dir, creates a cloud-masked raster band for each selected band
based on the SCL layer. Applies a rough haze correction based on thresholding the blue band (optional).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l2_dir</strong> (<em>str</em>) – The directory containing a set of L2 .SAFE folders to preprocess</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – The directory to store the preprocessed files</p></li>
<li><p><strong>scl_classes</strong> (<em>list</em><em> of </em><em>int</em>) – values of classes to be masked out</p></li>
<li><p><strong>buffer_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The buffer to apply to the sen2cor mask - defaults to 0</p></li>
<li><p><strong>bands</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – List of names of bands to include in the final rasters. Defaults to (“B02”, “B03”, “B04”, “B08”)</p></li>
<li><p><strong>out_resolution</strong> (<em>number</em><em>, </em><em>optional</em>) – Resolution to resample every image to - units are defined by the image projection. Default is 10.</p></li>
<li><p><strong>haze</strong> (<em>number</em><em>, </em><em>optional</em>) – Threshold if a haze filter is to be applied. If specified, all pixel values where “B02” &gt; haze will be masked out.
Defaults to None. If set, recommended thresholds range from 325 to 600 but can vary by scene conditions.</p></li>
<li><p><strong>epsg</strong> (<em>int</em>) – EPSG code of the map projection / CRS if output rasters shall be reprojected (warped)</p></li>
<li><p><strong>skip_existing</strong> (<em>boolean</em>) – If True, skip cloud masking if a file already exists. If False, overwrite it.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.apply_sen2cor">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">apply_sen2cor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sen2cor_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_unprocessed_image=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log=&lt;Logger</span> <span class="pre">pyeo.raster_manipulation</span> <span class="pre">(WARNING)&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.apply_sen2cor" title="Permalink to this definition"></a></dt>
<dd><p>Applies sen2cor to the SAFE file at image_path. Returns the path to the new product.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_path</strong> (<em>str</em>) – Path to the L1C Sentinel 2 .SAFE file directory</p></li>
<li><p><strong>sen2cor_path</strong> (<em>str</em>) – Path to the l2a_process script (Linux) or l2a_process.exe (Windows)</p></li>
<li><p><strong>delete_unprocessed_image</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, delete the unprocessed image after processing is done. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_path</strong> – The path to the new L2 .SAFE file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.array2raster">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">array2raster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_raster_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.array2raster" title="Permalink to this definition"></a></dt>
<dd><p>Saves the contents of an array to a new raster file and copies the projection from
an existing raster file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster_file</strong> (<em>str</em>) – Path and file name of the raster file from which the metadata will be copied</p></li>
<li><p><strong>new_raster_file</strong> (<em>str</em>) – Path and file name of the newly created raster file</p></li>
<li><p><strong>array</strong> (<em>array</em>) – The array that will be written to new_raster_file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.atmospheric_correction">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">atmospheric_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sen2cor_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_unprocessed_image=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log=&lt;Logger</span> <span class="pre">pyeo.raster_manipulation</span> <span class="pre">(WARNING)&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.atmospheric_correction" title="Permalink to this definition"></a></dt>
<dd><p>Applies Sen2cor atmospheric correction to each L1C image in in_directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_directory</strong> (<em>str</em>) – Path to the directory containing the L1C images</p></li>
<li><p><strong>out_directory</strong> (<em>str</em>) – Path to the directory that will containg the new L2A images</p></li>
<li><p><strong>sen2cor_path</strong> (<em>str</em>) – Path to the l2a_process script (Linux) or l2a_process.exe (Windows)</p></li>
<li><p><strong>delete_unprocessed_image</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, delete the unprocessed image after processing is done. Defaults to False.</p></li>
<li><p><strong>log</strong> (<em>optional</em>) – if a logger object is provided, <cite>atmospheric_correction</cite> will pass statements to that logger, otherwise the default namespace logger is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.average_images">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">average_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'intersect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.average_images" title="Permalink to this definition"></a></dt>
<dd><p>When provided with a list of rasters, will stack them into a single raster. The number of
bands in the output is equal to the total number of bands in the input. Geotransform and projection
are taken from the first raster in the list; there may be unexpected behavior if multiple differing
projections are provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster_paths</strong> (<em>list</em><em> of </em><em>str</em>) – A list of paths to the rasters to be stacked, in order.</p></li>
<li><p><strong>out_raster_path</strong> (<em>str</em>) – The path to the saved output raster.</p></li>
<li><p><strong>geometry_mode</strong> (<em>{'intersect'</em><em> or </em><em>'union'}</em><em>, </em><em>optional</em>) – Can be either ‘intersect’ or ‘union’. Defaults to ‘intersect’.</p></li>
<li><p><strong>'intersect'</strong> (<em>- If</em>) – </p></li>
<li><p><strong>overlap.</strong> (<em>then the output raster will only contain the pixels</em><em> of </em><em>the input rasters that</em>) – </p></li>
<li><p><strong>'union'</strong> (<em>- If</em>) – </p></li>
<li><p><strong>0.</strong> (<em>then the output raster will contain every pixel in the outputs. Layers without data will have their pixel values set to</em>) – </p></li>
<li><p><strong>format</strong> (<em>str</em>) – The GDAL image format for the output. Defaults to ‘GTiff’</p></li>
<li><p><strong>datatype</strong> (<em>gdal datatype</em>) – The datatype of the gdal array - see note. Defaults to gdal.GDT_Int32</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.buffer_mask_in_place">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">buffer_mask_in_place</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.buffer_mask_in_place" title="Permalink to this definition"></a></dt>
<dd><p>Expands a mask in-place, overwriting the previous mask</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_path</strong> (<em>str</em>) – Path to a multiplicative mask (0; masked, 1; unmasked)</p></li>
<li><p><strong>buffer_size</strong> (<em>int</em>) – The radius of the buffer, in pixel units of the mask</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.build_sen2cor_output_path">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">build_sen2cor_output_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.build_sen2cor_output_path" title="Permalink to this definition"></a></dt>
<dd><p>Creates a sen2cor output path dependent on the version of sen2cor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_path</strong> (<em>str</em>) – Path to the image</p></li>
<li><p><strong>timestamp</strong> (<em>str</em>) – Timestamp that processing was started (required for v &gt;= 2.8)</p></li>
<li><p><strong>version</strong> (<em>str</em>) – String of the version of sen2cor (ex “2.05.05”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_path</strong> – The path of the finished sen2cor file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.calc_ndvi">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">calc_ndvi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.calc_ndvi" title="Permalink to this definition"></a></dt>
<dd><p>Creates a raster of NDVI from the input raster at output_path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster_path</strong> (<em>str</em>) – Path to a raster with blue, green, red and infrared bands (in that order)</p></li>
<li><p><strong>output_path</strong> (<em>str</em>) – Path to a location to save the output raster</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.change_from_class_maps">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">change_from_class_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_class_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_class_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_from</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_to</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.change_from_class_maps" title="Permalink to this definition"></a></dt>
<dd><p>This function looks for changes from class ‘change_from’ in the composite to any of the ‘change_to_classes’
in the change images. Pixel values are the acquisition date of the detected change of interest or zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_class_path</strong> (<em>str</em>) – Paths to a classification map to be used as the baseline map for the change detection.</p></li>
<li><p><strong>new_class_path</strong> (<em>str</em>) – Paths to a classification map with a newer acquisition date.</p></li>
<li><p><strong>change_raster</strong> (<em>str</em><em> (</em><em>path to a raster file</em><em> of </em><em>type UInt32</em><em>)</em>) – Path to the output raster file that will be created.</p></li>
<li><p><strong>change_from</strong> (<em>list</em><em> of </em><em>int</em>) – List of integers with the class codes to be used as ‘from’ in the change detection.</p></li>
<li><p><strong>change_to</strong> (<em>list</em><em> of </em><em>int</em>) – List of integers with the class codes to be used as ‘to’ in the change detection.</p></li>
<li><p><strong>skip_existing</strong> (<em>boolean</em>) – If True, skip the production of files that already exist.</p></li>
<li><p><strong>Returns</strong> – </p></li>
<li><p><strong>----------</strong> – </p></li>
<li><p><strong>change_raster</strong> – The path to the new change layer containing the acquisition date of the new class image
expressed as the difference to the 1/1/2000, where a change has been found, or zero otherwise.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.clever_composite_directory">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">clever_composite_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composite_out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_date_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_data_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.clever_composite_directory" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Using clever_composite_images, creates a composite containing every image in image_dir. This will</dt><dd><p>place a file named composite_[last image date].tif inside composite_out_dir</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_dir</strong> (<em>str</em>) – The directory containing the rasters and associated .msk files to be composited.</p></li>
<li><p><strong>composite_out_dir</strong> (<em>str</em>) – The directory that will contain the final composite</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The raster format of the output image. Defaults to ‘GTiff’</p></li>
<li><p><strong>generate_date_images</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, generates a corresponding date image for the composite. See docs for composite_images_with_mask.
Defaults to False.</p></li>
<li><p><strong>missing_data_value</strong> (<em>int</em><em>, </em><em>optional</em>) – Value for no data encoding, will be ignored in calculating the median</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>composite_out_path</strong> – The path to the new composite</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.clever_composite_directory_with_masks">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">clever_composite_directory_with_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composite_out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_date_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_data_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.clever_composite_directory_with_masks" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Using clever_composite_images_with_mask, creates a composite containing every image in image_dir. This will</dt><dd><p>place a file named composite_[last image date].tif inside composite_out_dir</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_dir</strong> (<em>str</em>) – The directory containing the rasters and associated .msk files to be composited.</p></li>
<li><p><strong>composite_out_dir</strong> (<em>str</em>) – The directory that will contain the final composite</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The raster format of the output image. Defaults to ‘GTiff’</p></li>
<li><p><strong>generate_date_images</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, generates a corresponding date image for the composite. See docs for composite_images_with_mask.
Defaults to False.</p></li>
<li><p><strong>missing_data_value</strong> (<em>int</em><em>, </em><em>optional</em>) – Value for no data encoding, will be ignored in calculating the median</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>composite_out_path</strong> – The path to the new composite</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.clever_composite_images">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">clever_composite_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_raster_path_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composite_out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_date_image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_data_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.clever_composite_images" title="Permalink to this definition"></a></dt>
<dd><p>Works down in_raster_path_list, updating pixels in composite_out_path if not masked. Will also create
(optionally) a date image in the same directory. Processes raster stacks by splitting them into a number of chunks
to avoid memory allocation errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_raster_path_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of paths to rasters.</p></li>
<li><p><strong>composite_out_path</strong> (<em>str</em>) – The path of the output image</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The gdal format of the image. Defaults to “GTiff”</p></li>
<li><p><strong>generate_date_image</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, generates a single-layer raster containing the dates of each image detected - see below.</p></li>
<li><p><strong>missing_data_value</strong> (<em>int</em><em>, </em><em>optional</em>) – Value for no data encoding, will be ignored in calculating the median</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>composite_path</strong> – The path to the composite.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If generate_date_images is True, an raster ending with the suffix .date will be created; each pixel will contain the
timestamp (yyyymmdd) of the date that pixel was last seen in the composite.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.clever_composite_images_with_mask">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">clever_composite_images_with_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_raster_path_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composite_out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_date_image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_data_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.clever_composite_images_with_mask" title="Permalink to this definition"></a></dt>
<dd><p>Works down in_raster_path_list, updating pixels in composite_out_path if not masked. Will also create a mask and
(optionally) a date image in the same directory. Processes raster stacks by splitting them into a number of chunks
to avoid memory allocation errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_raster_path_list</strong> (<em>list</em><em> of </em><em>str</em>) – A list of paths to rasters.</p></li>
<li><p><strong>composite_out_path</strong> (<em>str</em>) – The path of the output image</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The gdal format of the image. Defaults to “GTiff”</p></li>
<li><p><strong>generate_date_image</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, generates a single-layer raster containing the dates of each image detected - see below.</p></li>
<li><p><strong>missing_data_value</strong> (<em>int</em><em>, </em><em>optional</em>) – Value for no data encoding, will be ignored in calculating the median</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>composite_path</strong> – The path to the composite.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Masks are assumed to be a multiplicative .msk file with the same path as their corresponding image.
All images must have the same number of layers and resolution, but do not have to be perfectly co-registered.
If it does not exist, composite_out_path will be created. Takes projection, resolution, etc. from first band
of first raster in list. Will reproject images and masks if they do not match initial raster.</p>
<p>If generate_date_images is True, an raster ending with the suffix .date will be created; each pixel will contain the
timestamp (yyyymmdd) of the date that pixel was last seen in the composite.</p>
<p>#TODO: Change the date image to contain Julian date numbers.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.clip_raster">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">clip_raster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aoi_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srs_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4326</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip_x_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_nodata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.clip_raster" title="Permalink to this definition"></a></dt>
<dd><p>Clips a raster at raster_path to a shapefile given by aoi_path. Assumes a shapefile only has one polygon.
Will np.floor() when converting from geo to pixel units and np.absolute() y resolution form geotransform.
Will also reproject the shapefile to the same projection as the raster if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster_path</strong> (<em>str</em>) – Path to the raster to be clipped.</p></li>
<li><p><strong>aoi_path</strong> (<em>str</em>) – Path to a shapefile containing a single polygon</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – Path to a location to save the final output raster</p></li>
<li><p><strong>flip_x_y</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, swaps the x and y axis of the raster image before clipping. For compatability with Landsat.
Default is False.</p></li>
<li><p><strong>dest_nodata</strong> (<em>number</em><em>, </em><em>optional</em>) – The fill value for outside of the clipped area. Defaults to 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.clip_raster_to_intersection">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">clip_raster_to_intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster_to_clip_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extent_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_landsat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.clip_raster_to_intersection" title="Permalink to this definition"></a></dt>
<dd><p>Clips one raster to the extent provided by the other raster, and saves the result at temp_file.
Assumes both raster_to_clip and extent_raster are in the same projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster_to_clip_path</strong> (<em>str</em>) – The location of the raster to be clipped.</p></li>
<li><p><strong>extent_raster_path</strong> (<em>str</em>) – The location of the raster that will provide the extent to clip to</p></li>
<li><p><strong>out_raster_path</strong> (<em>str</em>) – A location for the finished raster</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.combine_date_maps">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">combine_date_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date_image_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_product</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.combine_date_maps" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Combines all change date layers into one output raster with two layers:</dt><dd><ol class="arabic simple">
<li><p>pixels show the earliest change detection date (expressed as the number of days since 1/1/2000)</p></li>
<li><p>pixels show the number of change detection dates (summed up over all change images in the folder)</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date_image_paths</strong> (<em>list</em><em> of </em><em>strings</em>) – Containing the full directory paths to the input files with the detection dates as pixel values in UInt32 format</p></li>
<li><p><strong>output_product</strong> (<em>string</em>) – The string containing the full directory path to the output file for the 2-layer raster file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>output_product</strong> – The string containing the full directory path to the output file for the 2-layer raster file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.combine_masks">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">combine_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combination_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'and'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'intersect'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.combine_masks" title="Permalink to this definition"></a></dt>
<dd><p>ORs or ANDs several masks. Gets metadata from top mask. Assumes that masks are a
Python true or false. Also assumes that all masks are the same projection for now.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_paths</strong> (<em>list</em><em> of </em><em>str</em>) – A list of paths to the masks to combine</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – The path to the new mask</p></li>
<li><p><strong>combination_func</strong> (<em>{'and'</em><em> or </em><em>'or}</em><em>, </em><em>optional</em>) – Whether the a pixel in the final mask will be masked if
- any pixel (‘or’) is masked
- or all pixels (‘and’) are masked
..in the corresponding pixels in the list of masks. Defaults to ‘and’</p></li>
<li><p><strong>geometry_func</strong> (<em>{'intersect'</em><em> or </em><em>'union'}</em>) – How to handle non-overlapping masks. Defaults to ‘intersect’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_path</strong> – The path to the new mask</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.composite_directory">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">composite_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composite_out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_date_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.composite_directory" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Using composite_images_with_mask, creates a composite containing every image in image_dir. This will</dt><dd><p>place a file named composite_[last image date].tif inside composite_out_dir</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_dir</strong> (<em>str</em>) – The directory containing the rasters and associated .msk files to be composited.</p></li>
<li><p><strong>composite_out_dir</strong> (<em>str</em>) – The directory that will contain the final composite</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The raster format of the output image. Defaults to ‘GTiff’</p></li>
<li><p><strong>generate_date_images</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, generates a corresponding date image for the composite. See docs for composite_images_with_mask.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>composite_out_path</strong> – The path to the new composite</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.composite_images_with_mask">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">composite_images_with_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_raster_path_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composite_out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_date_image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.composite_images_with_mask" title="Permalink to this definition"></a></dt>
<dd><p>Works down in_raster_path_list, updating pixels in composite_out_path if not masked. Will also create a mask and
(optionally) a date image in the same directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_raster_path_list</strong> (<em>list</em><em> of </em><em>str</em>) – A list of paths to rasters.</p></li>
<li><p><strong>composite_out_path</strong> (<em>str</em>) – The path of the output image</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The gdal format of the image. Defaults to “GTiff”</p></li>
<li><p><strong>generate_date_image</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, generates a single-layer raster containing the dates of each image detected - see below.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>composite_path</strong> – The path to the composite.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Masks are assumed to be a multiplicative .msk file with the same path as their corresponding image; see REFERENCE.
All images must have the same number of layers and resolution, but do not have to be perfectly on top of each
other. If it does not exist, composite_out_path will be created. Takes projection, resolution, etc. from first band
of first raster in list. Will reproject images and masks if they do not match initial raster.</p>
<p>If generate_date_images is True, an raster ending with the suffix .date will be created; each pixel will contain the
timestamp (yyyymmdd) of the date that pixel was last seen in the composite.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.compress_tiff">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">compress_tiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.compress_tiff" title="Permalink to this definition"></a></dt>
<dd><p>Compresses a Geotiff file using gdal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_path</strong> (<em>str</em>) – The path to the input GeoTiff file.</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – The path to the output GeoTiff file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.create_mask_from_band">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">create_mask_from_band</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'smaller'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.create_mask_from_band" title="Permalink to this definition"></a></dt>
<dd><p>Creates a multiplicative mask from a classification mask: 1 for each pixel containing one of classes_of_interest,
otherwise 0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_raster_path</strong> (<em>str</em>) – Path to the raster file to build the mask from</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – Path to the new mask</p></li>
<li><p><strong>band</strong> (<em>number</em>) – Number of the band in the raster file to be used to create the mask, starting with band 1</p></li>
<li><p><strong>threshold</strong> (<em>number</em>) – Threshold to be applied when creating the mask</p></li>
<li><p><strong>relation</strong> (<em>str</em>) – Relationship to be applied to the threshold, can be that pixels are “smaller” or “greater”
than the threshold to be set to 1.</p></li>
<li><p><strong>buffer_size</strong> (<em>int</em>) – If greater than 0, applies a buffer to the masked pixels of this size. Defaults to 0.</p></li>
<li><p><strong>out_resolution</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If present, resamples the mask to this resolution. Applied before buffering. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_path</strong> – The path to the new mask.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.create_mask_from_class_map">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">create_mask_from_class_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_map_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes_of_interest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.create_mask_from_class_map" title="Permalink to this definition"></a></dt>
<dd><p>Creates a multiplicative mask from a classification mask: 1 for each pixel containing one of classes_of_interest,
otherwise 0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_map_path</strong> (<em>str</em>) – Path to the classification map to build the mask from</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – Path to the new mask</p></li>
<li><p><strong>classes_of_interest</strong> (<em>list</em><em> of </em><em>int</em>) – The list of classes to count as clear pixels</p></li>
<li><p><strong>buffer_size</strong> (<em>int</em>) – If greater than 0, applies a buffer to the masked pixels of this size. Defaults to 0.</p></li>
<li><p><strong>out_resolution</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If present, resamples the mask to this resoltion. Applied before buffering. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_path</strong> – The path to the new mask.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.create_mask_from_confidence_layer">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">create_mask_from_confidence_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l2_safe_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cloud_conf_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.create_mask_from_confidence_layer" title="Permalink to this definition"></a></dt>
<dd><p>Creates a multiplicative binary mask where cloudy pixels are 0 and non-cloudy pixels are 1. If
cloud_conf_threshold = 0, use scl mask else use confidence image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l2_safe_path</strong> (<em>str</em>) – Path to the L1</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – Path to the new path</p></li>
<li><p><strong>cloud_conf_threshold</strong> (<em>int</em><em>, </em><em>optional</em>) – If 0, uses the sen2cor classification raster as the base for the mask - else uses the cloud confidence image.
Defaults to 0</p></li>
<li><p><strong>buffer_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The size of the buffer to apply to the cloudy pixel classes</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_path</strong> – The path to the mask</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.create_mask_from_fmask">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">create_mask_from_fmask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_l1_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.create_mask_from_fmask" title="Permalink to this definition"></a></dt>
<dd><p>Creates a cloud mask from a level 1 Sentinel-2 product using fmask</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_l1_dir</strong> (<em>str</em>) – The path to the l1 .SAFE folder</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – The path to new mask</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.create_mask_from_model">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">create_mask_from_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_clear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.create_mask_from_model" title="Permalink to this definition"></a></dt>
<dd><p>Returns a multiplicative mask (0 for cloud, shadow or haze, 1 for clear) built from the ML at model_path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_path</strong> (<em>str</em>) – Path to the image</p></li>
<li><p><strong>model_path</strong> (<em>str</em>) – Path to a pickled scikit-learn classification model</p></li>
<li><p><strong>model_clear</strong> (<em>int</em><em>, </em><em>optional</em>) – The class from the model corresponding to non-cloudy pixels. Defaults to 0</p></li>
<li><p><strong>num_chunks</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of chunks to break the processing into. See <code class="xref py py-func docutils literal notranslate"><span class="pre">classification.classify_image()</span></code></p></li>
<li><p><strong>buffer_size</strong> (<em>int</em><em>, </em><em>optional</em>) – If present, will apply a buffer of this many pixels to the mask, expanding</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mask_path</strong> – The path to the new mask</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.create_mask_from_scl_layer">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">create_mask_from_scl_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l2_safe_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scl_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.create_mask_from_scl_layer" title="Permalink to this definition"></a></dt>
<dd><p>Creates a multiplicative binary mask where pixels of class scl_class are set to 0 and
other pixels are 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l2_safe_path</strong> (<em>str</em>) – Path to the L1</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – Path to the new path</p></li>
<li><p><strong>scl_classes</strong> (<em>list</em><em> of </em><em>int</em>) – Class values of the SCL scene classification layer to be set to 0</p></li>
<li><p><strong>buffer_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The size of the buffer to apply around the masked out pixels (dilation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_path</strong> – The path to the mask</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The SCL codes correspond to the following classification labels:</p>
<ul class="simple">
<li><p>0: NO_DATA</p></li>
<li><p>1: SATURATED_OR_DEFECTIVE</p></li>
<li><p>2: DARK_AREA_PIXELS</p></li>
<li><p>3: CLOUD_SHADOWS</p></li>
<li><p>4: VEGETATION</p></li>
<li><p>5: NOT_VEGETATED</p></li>
<li><p>6: WATER</p></li>
<li><p>7: UNCLASSIFIED</p></li>
<li><p>8: CLOUD_MEDIUM_PROBABILITY</p></li>
<li><p>9: CLOUD_HIGH_PROBABILITY</p></li>
<li><p>10: THIN_CIRRUS</p></li>
<li><p>11: SNOW</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.create_mask_from_sen2cor_and_fmask">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">create_mask_from_sen2cor_and_fmask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l1_safe_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_safe_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_mask_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.create_mask_from_sen2cor_and_fmask" title="Permalink to this definition"></a></dt>
<dd><p>Creates a cloud mask from a combination of the sen2cor thematic mask and the fmask method. Requires corresponding
level 1 and level 2 .SAFE files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l1_safe_file</strong> (<em>str</em>) – Path to the level 1 .SAFE file</p></li>
<li><p><strong>l2_safe_file</strong> (<em>str</em>) – Path to the level 2 .SAFE file</p></li>
<li><p><strong>out_mask_path</strong> (<em>str</em>) – Path to the new mask</p></li>
<li><p><strong>buffer_size</strong> (<em>int</em><em>, </em><em>optional</em>) – If greater than 0, the buffer to apply to the Sentinel 2 thematic map</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.create_matching_dataset">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">create_matching_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.create_matching_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Creates an empty gdal dataset with the same dimensions, projection and geotransform as in_dataset.
Defaults to 1 band.
Datatype is set from the first layer of in_dataset if unspecified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_dataset</strong> (<em>gdal.Dataset</em>) – A gdal.Dataset object</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – The path to save the copied dataset to</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The Gdal image format. Defaults to geotiff (“GTiff”); for a full list, see <a class="reference external" href="https://gdal.org/drivers/raster/index.html">https://gdal.org/drivers/raster/index.html</a></p></li>
<li><p><strong>bands</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of bands in the dataset. Defaults to 1.</p></li>
<li><p><strong>datatype</strong> (<em>gdal constant</em><em>, </em><em>optional</em>) – The datatype of the returned dataset. See the introduction for this module. Defaults to in_dataset’s datatype
if not supplied.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_dataset</strong> – An gdal.Dataset of the new, empty dataset that is ready for writing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>gdal.Dataset</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The default of bands=1 will be changed to match the input dataset in the next release of pyeo</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.create_new_image_from_polygon">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">create_new_image_from_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.create_new_image_from_polygon" title="Permalink to this definition"></a></dt>
<dd><p>Returns an empty image that covers the extent of the input polygon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>polygon</strong> (<em>ogr.Geometry</em>) – An OGR.Geometry object of a single polygon</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – The path to save the new image to</p></li>
<li><p><strong>x_res</strong> (<em>number</em>) – Pixel width in the new image</p></li>
<li><p><strong>y_res</strong> (<em>number</em>) – Pixel height in the new image</p></li>
<li><p><strong>bands</strong> (<em>int</em>) – Number of bands in the new image.</p></li>
<li><p><strong>projection</strong> (<em>str</em>) – The projection, in wkt, of the output image.</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The gdal raster format of the output image. Defaults to “Gtiff”</p></li>
<li><p><strong>datatype</strong> (<em>gdal datatype</em><em>, </em><em>optional</em>) – The gdal datatype of the output image. Defaults to gdal.GDT_Int32</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A gdal.Image object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.create_new_stacks">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">create_new_stacks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.create_new_stacks" title="Permalink to this definition"></a></dt>
<dd><p>For each granule present in image_dir Saves the result in stacked_dir.
Assumes that each image in image_dir is saved with a Sentinel-2 identifier name - see merge_raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_dir</strong> (<em>str</em>) – A path to the directory containing the images to be stacked, all named as Sentinel 2 identifiers</p></li>
<li><p><strong>stack_dir</strong> (<em>str</em>) – A path to a directory to save the stacked images to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>new_stacks</strong> – A list of paths to the new stacks</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The pairing algorithm is as follows:
Step 1: Group directory by tile number
Step 2: For each tile number, sort by time
Step 3: For each image in the sorted list, stack each image with it’s next oldest image.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>CreateNewStacksException</strong> – If the image directory is empty</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.create_quicklook">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">create_quicklook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PNG'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.create_quicklook" title="Permalink to this definition"></a></dt>
<dd><p>Creates a quicklook image of reduced size from an input GDAL object and saves it to out_raster_path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_raster_path</strong> (<em>string</em>) – The string containing the full directory path to the input file for the quicklook</p></li>
<li><p><strong>out_raster_path</strong> (<em>string</em>) – The string containing the full directory path to the output file for the quicklook</p></li>
<li><p><strong>width</strong> (<em>number</em>) – Width of the output raster in pixels</p></li>
<li><p><strong>height</strong> (<em>number</em>) – Height of the output raster in pixels</p></li>
<li><p><strong>format</strong> (<em>string</em><em>, </em><em>optional</em>) – GDAL format for the quicklook raster file, default PNG</p></li>
<li><p><strong>bands</strong> (<em>list</em><em> of </em><em>numbers</em>) – List of the band numbers to be displayed as RGB. Will be ignored if only one band is in the image raster.</p></li>
<li><p><strong>nodata</strong> (<em>number</em><em> (</em><em>optional</em><em>)</em>) – Missing data value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_raster_path</strong> – The output path of the generated quicklook raster file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.filter_by_class_map">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">filter_by_class_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_map_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_map_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes_of_interest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.filter_by_class_map" title="Permalink to this definition"></a></dt>
<dd><p>Filters a raster with a set of classes for corresponding for pixels in filter_map_path containing only
classes_of_interest. Assumes that filter_map_path and class_map_path are same resolution and projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_path</strong> (<em>str</em>) – Path to the raster to be filtered.</p></li>
<li><p><strong>class_map_path</strong> (<em>str</em>) – Path to the map to use as the filter. Assumes a raster of integer class labels.</p></li>
<li><p><strong>out_map_path</strong> (<em>str</em>) – Path to the filtered map</p></li>
<li><p><strong>classes_of_interest</strong> (<em>list</em><em> of </em><em>int</em>) – The classes in class_map_path to keep present in the raster to be filtered</p></li>
<li><p><strong>out_resolution</strong> (<em>number</em><em>, </em><em>optional</em>) – The resolution of the output image</p></li>
<li><p><strong>invert</strong> (<em>bool</em><em>, </em><em>optional</em>) – If present, invert mask (ie filter out classes_of_interest)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_map_path</strong> – The path to the new map</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.find_small_safe_dirs">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">find_small_safe_dirs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">629145600</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.find_small_safe_dirs" title="Permalink to this definition"></a></dt>
<dd><p>Quickly finds all subdirectories ending with “.SAFE” or “.safe” and logs a warning if the
directory size is less than a threshold, 600 MB by default. This indicates incomplete downloads</p>
<p>Returns a list of all paths to the SAFE directories that are smaller than the threshold and a list of all sizes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.flatten_probability_image">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">flatten_probability_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prob_image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.flatten_probability_image" title="Permalink to this definition"></a></dt>
<dd><p>Takes a probability output from classify_image and flattens it into a single layer containing only the maximum
value from each pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prob_image</strong> (<em>str</em>) – The path to a probability image.</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – The place to save the flattened image.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.get_array">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">get_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.get_array" title="Permalink to this definition"></a></dt>
<dd><p>Returns a numpy array for the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>raster</strong> (<em>gdal.Dataset</em>) – A gdal.Dataset object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>array</strong> – A numpy array of the raster</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.get_dir_size">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">get_dir_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.get_dir_size" title="Permalink to this definition"></a></dt>
<dd><p>Gets the size of all contents of a directory.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.get_extent_as_shp">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">get_extent_as_shp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_ras_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_shp_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.get_extent_as_shp" title="Permalink to this definition"></a></dt>
<dd><p>Gets the extent of a raster as a shapefile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_ras_path</strong> (<em>str</em>) – The raster to get</p></li>
<li><p><strong>out_shp_path</strong> (<em>str</em>) – The shape path</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_shp_path</strong> – The path to the new shapefile</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.get_file_sizes">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">get_file_sizes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.get_file_sizes" title="Permalink to this definition"></a></dt>
<dd><p>Gets all file sizes in bytes from the files contained in dir_path and its subdirs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_path</strong> (<em>str</em>) – Paths to the files.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>results</strong> – Dictionary containing the results of the function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.get_image_resolution">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">get_image_resolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.get_image_resolution" title="Permalink to this definition"></a></dt>
<dd><p>Returns the resolution of the image in its native projection. Assumes square pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>image_path</strong> (<em>str</em>) – Path to a raster</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>resolution</strong> – The size of each pixel in the image, in the units of its native projection.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.get_masked_array">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">get_masked_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.get_masked_array" title="Permalink to this definition"></a></dt>
<dd><p>Returns a numpy.mask masked array for the raster.
Masked pixels are FALSE in the mask image (multiplicateive map),
but TRUE in the masked_array (nodata pixels). If the raster is multi-band and
the mask is single-band, the mask will be applied to every raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> (<em>gdal.Dataset</em>) – A gdal.Dataset object</p></li>
<li><p><strong>mask_path</strong> (<em>str</em>) – The path to the mask to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>masked_array</strong> – A numpy.masked array of the raster.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.masked</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.get_sen2cor_version">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">get_sen2cor_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sen2cor_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.get_sen2cor_version" title="Permalink to this definition"></a></dt>
<dd><p>Gets the version number of sen2cor from the help string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sen2cor_path</strong> (<em>str</em>) – Path to the sen2cor executable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>version</strong> – A string of the version of sen2cor at sen2cor_path</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.get_sen_2_band_path">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">get_sen_2_band_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">safe_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.get_sen_2_band_path" title="Permalink to this definition"></a></dt>
<dd><p>Returns the path to the raster of the specified band in the specified safe_dir.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>safe_dir</strong> (<em>str</em>) – Path to the directory containing the raster</p></li>
<li><p><strong>band</strong> (<em>str</em>) – The band identifier (‘B01’, ‘B02’, ect)</p></li>
<li><p><strong>resolution</strong> (<em>int</em><em>, </em><em>optional</em>) – If given, tries to get that band in that image - if not, tries for the highest resolution</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>band_path</strong> – The path to the raster containing the band.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.get_stats_from_raster_file">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">get_stats_from_raster_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_data_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.get_stats_from_raster_file" title="Permalink to this definition"></a></dt>
<dd><p>Gets simple statistics from a raster file and prints them to the log file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_raster_path</strong> (<em>str</em>) – A path to a raster file</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The gdal format of the image. Defaults to “GTiff”</p></li>
<li><p><strong>missing_data_value</strong> (<em>int</em><em>, </em><em>optional</em>) – The encoding of missing values in the raster that will be omitted from the calculations</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong> – Dictionary containing the results of the function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.mosaic_images">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">mosaic_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.mosaic_images" title="Permalink to this definition"></a></dt>
<dd><p>Mosaics multiple images in the directory raster_path with the same number of layers into one single image.
Overwrites overlapping pixels with the value furthest down raster_paths. Takes projection from the first raster.
The output mosaic file will have a name that contains all unique tile IDs and the earliest and latest
acquisition date and time from the raster file names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster_path</strong> (<em>str</em>) – The directory path containing all Geotiff rasters to be mosaiced (all having the same number of bands)</p></li>
<li><p><strong>out_raster_path</strong> (<em>str</em>) – The path to the output directory for the new mosaic file</p></li>
<li><p><strong>format</strong> (<em>str</em>) – The image format of the output raster. Defaults to ‘GTiff’</p></li>
<li><p><strong>datatype</strong> (<em>gdal datatype</em>) – The datatype of the output raster. Defaults to gdal.GDT_Int32</p></li>
<li><p><strong>nodata</strong> (<em>number</em>) – The input nodata value; any pixels in raster_paths with this value will be ignored. Defaults to 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.open_dataset_from_safe">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">open_dataset_from_safe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">safe_file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'10m'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.open_dataset_from_safe" title="Permalink to this definition"></a></dt>
<dd><p>Opens a dataset given a level 2 .SAFE file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>safe_file_path</strong> (<em>str</em>) – The path to the .SAFE file</p></li>
<li><p><strong>band</strong> (<em>int</em>) – The band to open</p></li>
<li><p><strong>resolution</strong> (<em>{'10m'</em><em>, </em><em>'20m'</em><em>, </em><em>'60m'}</em><em>, </em><em>optional</em>) – The resolution of imagery to open. Defaults to “10m”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>band_raster</strong> – A Gdal dataset contining the band</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>gdal.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.preprocess_landsat_images">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">preprocess_landsat_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands_to_stack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('B2',</span> <span class="pre">'B3',</span> <span class="pre">'B4')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.preprocess_landsat_images" title="Permalink to this definition"></a></dt>
<dd><p>Stacks a set of Landsat images into a single raster and reorders the bands into
[bands, y, x] - by default, Landsat uses [x,y] and bands are in seperate rasters.
If given, will also reproject to an EPSG or .wkt</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_dir</strong> (<em>str</em>) – The directory containing the Landsat images</p></li>
<li><p><strong>out_image_path</strong> (<em>str</em>) – The path to the stacked image</p></li>
<li><p><strong>new_projection</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – An EPSG number or a .wkt containing a projection. Defaults to None</p></li>
<li><p><strong>bands_to_stack</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – The Landsat bands to put into the stacked</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.preprocess_sen2_images">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">preprocess_sen2_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l2_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cloud_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('B02',</span> <span class="pre">'B03',</span> <span class="pre">'B04',</span> <span class="pre">'B08')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.preprocess_sen2_images" title="Permalink to this definition"></a></dt>
<dd><p>For every .SAFE folder in l2_dir and L1_dir, merges the rasters of bands 2,3,4 and 8 into a single geotiff file,
creates a cloudmask from the combined fmask and sen2cor cloudmasks and reprojects to a given EPSG if provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l2_dir</strong> (<em>str</em>) – The directory containing a set of L2 .SAFE folders to preprocess</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – The directory to store the preprocessed files</p></li>
<li><p><strong>l1_dir</strong> (<em>str</em>) – The directory containing a set of L1 .SAFE files, corresponding to the L2 files in l2_dir</p></li>
<li><p><strong>cloud_threshold</strong> (<em>number</em>) – DEPRECIATED; in for backwards compatibility.</p></li>
<li><p><strong>buffer_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The buffer to apply to the sen2cor mask - defaults to 0</p></li>
<li><p><strong>epsg</strong> (<em>int</em><em>, </em><em>optional</em>) – If present, the EPSG number to reproject the final images to.</p></li>
<li><p><strong>bands</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – List of names of bands to include in the final rasters. Defaults to (“B02”, “B03”, “B04”, “B08”)</p></li>
<li><p><strong>out_resolution</strong> (<em>number</em><em>, </em><em>optional</em>) – Resolution to resample every image to - units are defined by the image projection. Default is 10.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This functions’ augment list is likely to be changed in the near future to (l1_dir, l2_dir, out_dir) - please
be aware - September 2020.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.raster2array">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">raster2array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.raster2array" title="Permalink to this definition"></a></dt>
<dd><p>Loads the contents of a raster file into an array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>raster_file</strong> (<em>str</em>) – Path and file name of the raster file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.raster_sum">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">raster_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inRstList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outFn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outFmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.raster_sum" title="Permalink to this definition"></a></dt>
<dd><p>Creates a raster stack from a list of rasters. Adapted from Chris Gerard’s
book ‘Geoprocessing with Python’. The output data type is the same as the input data type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inRstList</strong> (<em>list</em><em> of </em><em>str</em>) – List of rasters to stack.</p></li>
<li><p><strong>outFn</strong> (<em>str</em>) – Filename output as str including directory else image will be
written to current working directory.</p></li>
<li><p><strong>outFmt</strong> (<em>str</em><em>, </em><em>optional.</em>) – String specifying the input data format e.g. ‘GTiff’ or ‘VRT’. Defaults to GTiff.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.raster_to_array">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">raster_to_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rst_pth</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.raster_to_array" title="Permalink to this definition"></a></dt>
<dd><p>Reads in a raster file and returns a N-dimensional array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rst_pth</strong> (<em>str</em>) – Path to input raster.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_array</strong> – An N-dimensional array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.reproject_directory">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">reproject_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_projection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.tif'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.reproject_directory" title="Permalink to this definition"></a></dt>
<dd><p>Reprojects every file ending with extension to new_projection and saves in out_dir</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_dir</strong> (<em>str</em>) – A directory containing the rasters to be reprojected/</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – The directory to save the output files to. Output files will be saved in out_dir, with the same
filenames.</p></li>
<li><p><strong>new_projection</strong> (<em>str</em>) – The new projection in wkt.</p></li>
<li><p><strong>extension</strong> (<em>str</em><em>, </em><em>optional</em>) – The file extension to reproject. Default is ‘.tif’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.reproject_image">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">reproject_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_projection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">driver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_post_resample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.reproject_image" title="Permalink to this definition"></a></dt>
<dd><p>Creates a new, reprojected image from in_raster using the gdal.ReprojectImage function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_raster</strong> (<em>str</em><em> or </em><em>gdal.Dataset</em>) – Either a gdal.Dataset object or a path to a raster</p></li>
<li><p><strong>out_raster_path</strong> (<em>str</em>) – The path to the new output raster.</p></li>
<li><p><strong>new_projection</strong> (<em>str</em><em> or </em><em>int</em>) – The new projection in .wkt or as an EPSG number</p></li>
<li><p><strong>driver</strong> (<em>str</em><em>, </em><em>optional</em>) – The format of the output raster.</p></li>
<li><p><strong>memory</strong> (<em>float</em><em>, </em><em>optional</em>) – The amount of memory to give to the reprojection. Defaults to 2e3</p></li>
<li><p><strong>do_post_resample</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set to false, do not resample the image back to the original projection. Defaults to True</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The GDAL reprojection routine changes the size of the pixels by a very small amount; for example, a 10m pixel image
can become a 10.002m pixel resolution image. To stop alignment issues, by default this function resamples the images
back to their original resolution. If you are reprojecting from latlon to meters and get an outofmemory error from
Gdal, set do_post_resample to False.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.resample_image_in_place">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">resample_image_in_place</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_res</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.resample_image_in_place" title="Permalink to this definition"></a></dt>
<dd><p>Resamples an image in-place using gdalwarp to new_res in metres.
WARNING: This will make a permanent change to an image! Use with care.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_path</strong> (<em>str</em>) – Path to the image to be resampled</p></li>
<li><p><strong>new_res</strong> (<em>number</em>) – Pixel edge size in meters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.save_array_as_image">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">save_array_as_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geotransform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.save_array_as_image" title="Permalink to this definition"></a></dt>
<dd><p>Saves a given array as a geospatial image to disk in the format ‘format’. The datatype will be of one corresponding
to Array must be gdal format: [bands, y, x].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>array_like</em>) – A Numpy array containing the values to be saved to a raster</p></li>
<li><p><strong>path</strong> (<em>str</em>) – The path to the location to save the output raster to</p></li>
<li><p><strong>geotransform</strong> (<em>list</em>) – The geotransform of the image to be saved. See note.</p></li>
<li><p><strong>projection</strong> (<em>str</em>) – The projection, as wkt, of the image to be saved. See note.</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The image format. Defaults to ‘GTiff’; see note for other types.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>path_to_image</strong> – The path to the image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.scale_to_uint8">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">scale_to_uint8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">100]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.scale_to_uint8" title="Permalink to this definition"></a></dt>
<dd><p>Scales an array to the range from 0-255 and converts the data type to uint8.
NaN values will be ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>x = input</em>) – </p></li>
<li><p><strong>histogram</strong> (<em>percentiles = list</em><em> of </em><em>length 2</em><em> of </em><em>percentiles for trimming the</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scaled array of uint8 data type</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.sieve_directory">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">sieve_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sieve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.sieve_directory" title="Permalink to this definition"></a></dt>
<dd><p>Sieves all class images ending in .tif in in_dir using gdal.
Outputs are saved out_dir.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_dir</strong> (<em>str</em>) – The path to the directory containing the class image files.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – The directory that will store the sieved class image files</p></li>
<li><p><strong>neighbours</strong> (<em>int</em>) – Number of neighbouring pixels at sieve stage. Can be 4 or 8.</p></li>
<li><p><strong>sieve</strong> (<em>int</em>) – Number of pixels in a class polygon. Only polygons below this threshold will be removed. See GDAL Sieve documentation.</p></li>
<li><p><strong>out_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The raster format of the class image. Defaults to “GTiff” (geotif). See gdal docs for valid datatypes.</p></li>
<li><p><strong>skip_existing</strong> (<em>boolean</em><em>, </em><em>optional</em>) – If True, skips the classification if the output file already exists.</p></li>
<li><p><strong>Returns</strong> – </p></li>
<li><p><strong>--------</strong> – </p></li>
<li><p><strong>out_image_paths</strong> (<em>list</em><em> of </em><em>str</em>) – A list with all paths to the sieved class image files, including those that already existed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.sieve_image">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">sieve_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sieve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_existing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.sieve_image" title="Permalink to this definition"></a></dt>
<dd><p>Sieves a class image using gdal. Output is saved out_path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_path</strong> (<em>str</em>) – The path to the class image file with a single band.</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – The path to the output file that will store the sieved class image.</p></li>
<li><p><strong>neighbours</strong> (<em>int</em>) – Number of neighbouring pixels at sieve stage. Can be 4 or 8.</p></li>
<li><p><strong>sieve</strong> (<em>int</em>) – Number of pixels in a class polygon. Only polygons below this threshold will be removed. See GDAL Sieve documentation.</p></li>
<li><p><strong>skip_existing</strong> (<em>boolean</em><em>, </em><em>optional</em>) – If True, skips the classification if the output file already exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.stack_and_trim_images">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">stack_and_trim_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aoi_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_image</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.stack_and_trim_images" title="Permalink to this definition"></a></dt>
<dd><p>Stacks an old and new S2 image and trims to within an aoi.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_image_path</strong> (<em>str</em>) – Path to the image that will be the first set of bands in the output image</p></li>
<li><p><strong>new_image_path</strong> (<em>str</em>) – Path to the image that will be the second set of bands in the output image</p></li>
<li><p><strong>aoi_path</strong> (<em>str</em>) – Path to a shapefile containing the AOI</p></li>
<li><p><strong>out_image</strong> (<em>str</em>) – Path to the location of the clipped and stacked image.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.stack_image_with_composite">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">stack_image_with_composite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composite_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_combined_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_if_exists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_stack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.stack_image_with_composite" title="Permalink to this definition"></a></dt>
<dd><p>Creates a single 8-band geotif image with a cloud-free composite and an image, and saves the result in out_dir. Output images are named
“composite_tile_timestamp-of-composite_timestamp-of-image”. Bands 1,2,3 and 4 are the B,G,R and NIR bands of the
composite, and bands 5,6,7 and 8 are the B,G,R and NIR bands of the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_path</strong> (<em>str</em>) – Path to the image to be stacked</p></li>
<li><p><strong>composite_path</strong> (<em>str</em>) – Path to the composite to stack the image with</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – The directory to save the resulting composite to</p></li>
<li><p><strong>create_combined_mask</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, combines the cloud mask files associated with the images into a single mask. The mask will mask out
clouds that exist in either image. Defaults to True.</p></li>
<li><p><strong>skip_if_exists</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, skip stacking if a file with the same name is found. Defaults to True.</p></li>
<li><p><strong>invert_stack</strong> (<em>bool</em><em>, </em><em>optional.</em>) – If true, changes the ordering of the bands to image BGRI - composite BGRI. Included to permit compatibility
with older models - you can usually leave this alone.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_path</strong> – The path to the new composite.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.stack_images">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">stack_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'intersect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodata_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.stack_images" title="Permalink to this definition"></a></dt>
<dd><p>When provided with a list of rasters, will stack them into a single raster. The number of
bands in the output is equal to the total number of bands in the input raster. Geotransform and projection
are taken from the first raster in the list; there may be unexpected behaviour if multiple differing
projections are provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster_paths</strong> (<em>list</em><em> of </em><em>str</em>) – A list of paths to the rasters to be stacked, in order.</p></li>
<li><p><strong>out_raster_path</strong> (<em>str</em>) – The path to the saved output raster.</p></li>
<li><p><strong>geometry_mode</strong> (<em>{'intersect'</em><em> or </em><em>'union'}</em>) – Can be either ‘intersect’ or ‘union’.</p></li>
<li><p><strong>'intersect'</strong> (<em>- If</em>) – </p></li>
<li><p><strong>overlap.</strong> (<em>then the output raster will only contain the pixels</em><em> of </em><em>the input rasters that</em>) – </p></li>
<li><p><strong>'union'</strong> (<em>- If</em>) – have their pixel values set to 0.</p></li>
<li><p><strong>will</strong> (<em>then the output raster will contain every pixel in the outputs. Layers without data</em>) – have their pixel values set to 0.</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The GDAL image format for the output. Defaults to ‘GTiff’</p></li>
<li><p><strong>datatype</strong> (<em>gdal datatype</em><em>, </em><em>optional</em>) – The datatype of the gdal array - see introduction. Defaults to gdal.GDT_Int32.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.stack_old_and_new_images">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">stack_old_and_new_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_combined_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.stack_old_and_new_images" title="Permalink to this definition"></a></dt>
<dd><p>Stacks two images that cover the same tile into a single multi-band raster, old_image_path being the first set of
bands and new_image_path being the second. The produced image will have the name <cite>{tile}_{old_date}_{new_date}.tif</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_image_path</strong> (<em>str</em>) – Path to the older image</p></li>
<li><p><strong>new_image_path</strong> (<em>str</em>) – Path to the newer image</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Directory to place the new stacked raster into</p></li>
<li><p><strong>create_combined_mask</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, finds and combines the associated mask files between</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_image_path</strong> – The path to the new image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.stack_sentinel_2_bands">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">stack_sentinel_2_bands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">safe_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_image_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('B02',</span> <span class="pre">'B03',</span> <span class="pre">'B04',</span> <span class="pre">'B08')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.stack_sentinel_2_bands" title="Permalink to this definition"></a></dt>
<dd><p>Stacks the specified bands of a .SAFE granule directory into a single geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>safe_dir</strong> (<em>str</em>) – Path to the .SAFE file to stack</p></li>
<li><p><strong>out_image_path</strong> (<em>str</em>) – Location of the new image</p></li>
<li><p><strong>bands</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – The band IDs to be stacked</p></li>
<li><p><strong>out_resolution</strong> – The final resolution of the geotif- bands will be resampled if needed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_image_path</strong> – The path to the new image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.strip_bands">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">strip_bands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands_to_strip</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.strip_bands" title="Permalink to this definition"></a></dt>
<dd><p>Removes bands from a raster and saves a copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_raster_path</strong> (<em>str</em>) – Path to the raster</p></li>
<li><p><strong>out_raster_path</strong> (<em>str</em>) – Path to the output</p></li>
<li><p><strong>bands_to_strip</strong> (<em>list</em><em> of </em><em>int</em>) – 0-indexed list of bands to remove</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_path</strong> – The path to the output</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.trim_image">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">trim_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polygon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.trim_image" title="Permalink to this definition"></a></dt>
<dd><p>Trims a raster to a polygon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_raster_path</strong> (<em>str</em>) – Path to the imput raster</p></li>
<li><p><strong>out_raster_path</strong> (<em>str</em>) – Path of the output raster</p></li>
<li><p><strong>polygon</strong> (<em>ogr.Geometry</em>) – A ogr.Geometry containing a single polygon</p></li>
<li><p><strong>format</strong> (<em>str</em>) – Image format of the output raster. Defaults to ‘GTiff’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.update_composite_with_images">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">update_composite_with_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">composite_in_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_raster_path_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composite_out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTiff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generate_date_image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.update_composite_with_images" title="Permalink to this definition"></a></dt>
<dd><p>Works down in_raster_path_list, updating pixels in composite_out_path if not masked. Will also create a mask and
(optionally) a date image in the same directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>composite_in_path</strong> (<em>str</em>) – The path of the input composite image to be updated</p></li>
<li><p><strong>in_raster_path_list</strong> (<em>list</em><em> of </em><em>str</em>) – A list of paths to rasters.</p></li>
<li><p><strong>composite_out_path</strong> (<em>str</em>) – The path of the output image</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The gdal format of the image. Defaults to “GTiff”</p></li>
<li><p><strong>generate_date_image</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, generates a single-layer raster containing the dates of each image detected - see below.</p></li>
<li><p><strong>missing</strong> (<em>missing value to be ignored</em><em>, </em><em>0 by default</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>composite_path</strong> (<em>str</em>) – The path to the composite.</p></li>
<li><p><em>Notes</em></p></li>
<li><p><em>If generate_date_images is True, an raster ending with the suffix .date will be created; each pixel will contain the</em></p></li>
<li><p><em>timestamp (yyyymmdd) of the date that pixel was last seen in the composite.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.verify_change_detections">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">verify_change_detections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_map_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes_of_interest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyeo.raster_manipulation.verify_change_detections" title="Permalink to this definition"></a></dt>
<dd><p>Verifies repeated change detections from subsequent class maps.
Reads in a list of classification masks where 1 shows pixels containing a change class and adds them up.
Classification maps are sorted by timestamp in the file name.
The result is a raster file that contains a number from 0 (no change detected) to n (number of mask files)
where n is the greatest confidence in the change detection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_map_paths</strong> (<em>list</em><em> of </em><em>str</em>) – List of paths to the classification maps to build the mask from</p></li>
<li><p><strong>out_path</strong> (<em>str</em>) – Path to the new raster file containing the confidence layer</p></li>
<li><p><strong>classes_of_interest</strong> (<em>list</em><em> of </em><em>int</em>) – The list of classes to count as clear pixels</p></li>
<li><p><strong>buffer_size</strong> (<em>int</em>) – If greater than 0, applies a buffer to the masked pixels of this size. Defaults to 0.</p></li>
<li><p><strong>out_resolution</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If present, resamples the mask to this resolution. Applied before buffering. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out_path</strong> – The path to the new mask.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyeo.raster_manipulation.write_n_band_tiff">
<span class="sig-prename descclassname"><span class="pre">pyeo.raster_manipulation.</span></span><span class="sig-name descname"><span class="pre">write_n_band_tiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiff_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#pyeo.raster_manipulation.write_n_band_tiff" title="Permalink to this definition"></a></dt>
<dd><p>This function takes a list of tiff paths and merges the tiffs into a single n-band image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tiff_paths</strong> (<em>list</em>) – List of tiff input images to merge</p></li>
<li><p><strong>output_path</strong> (<em>str</em>) – The path to the output GeoTiff file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="queries_and_downloads.html" class="btn btn-neutral float-left" title="Queries and Downloads" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="validation.html" class="btn btn-neutral float-right" title="Validation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, John Roberts, Ivan Reading, Matthew Payne, Heiko Balzter.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>